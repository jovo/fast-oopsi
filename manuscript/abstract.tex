\begin{abstract}
A fundamental desideratum in neuroscience is to simultaneously observe the spike trains from large populations of neurons. Calcium imaging technologies are bringing the field ever closer to achieving this goal, both in vitro and in vivo. To get the most information out of these preparations, one can increase the frame rate and image field, leading to corresponding increases in temporal resolution and number of observable cells.  However, these increases come at the cost of reducing the dwell time per pixel, causing a decrease in the signal-to-noise ratio.  Thus, to maximize the utility of these technologies, powerful computational tools must be built to compliment the experimental tools.  In particular, by considering the statistics of the data --- e.g., firing rates and photon counts are positive (or zero) --- we develop an approximately optimal algorithm for inferring spike trains from fluorescence data. More specifically, we use an interior-point method to perform a non-negative deconvolution, inferring the approximately most likely spike train for each neuron, given their fluorescence signals. We demonstrate using simulations, in vitro, and in vivo data-sets the improvement of our algorithm over other techniques.  Moreover, because our inference is very fast --- requiring only about 1 second of computational time on laptop to analyze a calcium trace from 50,000 image frames --- we call this approach the Fast Non-negative deconvolution Spike Inference (\foopsi) filter. We demonstrate that performing optimal spatial filtering on the images further refines the estimates.  Importantly, all the parameters required to perform our inference can be estimated using only the fluorescence data, obviating the need to perform simultaneous electrophysiological experiments.  Finally, all the code written to perform the inference is freely available.
\end{abstract}