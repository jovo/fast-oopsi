\begin{abstract}
Calcium imaging technologies for observing spiking activity simultaneously from large populations of neurons are quickly gaining popularity.  While the raw data are fluorescence movies, often, the underlying spike trains are of interest.  This work presents an online non-negative deconvolution filter to infer the approximately mostly likely spike trains for each neuron, given the fluorescence observations.  This algorithm outperforms optimal linear deconvolution (aka, Wiener filter) on both simulated and in vitro data, and requires approximately the same computational time.  The performance gains come from restricting the inferred spike trains to be positive (using an interior-point method), unlike the Wiener filter.  The algorithm is fast enough that even when simultaneously imaging $\approx 100$ neurons, inference can simultaneously be performed on all observed traces faster than real time.  Performing optimal spatial filtering on the images further refines the estimates.  Importantly, all the parameters required to perform the inference can be estimated using only the fluorescence data, obviating the need to perform simultaneous electrophysiological calibration experiments.
\end{abstract}