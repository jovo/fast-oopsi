function P = FastParams1_3(F,C,n,T,dt,Q)
% estimates parameters using mu=0;
%%
if exist('Q','var') && isfield(Q,'lam')
    P.lam=Q.lam;
else
    P.lam  = sum(n)/(T*dt);
end

if exist('Q') && isfield(Q,'lam')
    P.tau=Q.tau;
else
    W       = C(1:end-1);
    Y       = F(2:end)-n(2:end);
    a       = W\Y;
    if a(1)>1, a(1)=1; elseif a(1)<0, a(1)=0; end           % make sure 'a' is within bounds
    P.tau   = dt/(1-a(1));
end

if narginin==5
    DD      = (F-C)'*(F-C);                            % difference vector
    P.sig   = sqrt(DD/T);
else
    if any(Q.p==3)
        P.sig=Q.sig;
    end
end

c       = 1/(2*P.sig^2);                    % scale of variance
P.lik   = 0.5*T*log(2*pi*P.sig^2) + c*DD - T*log(P.lam*dt) + P.lam*dt*sum(n);% initialize likelihood

end